<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="aws data transfer 트래픽 문제(폰트)" /><meta name="author" content="Yongheon Choi" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="aws data transfer 트래픽 이상" /><meta property="og:description" content="aws data transfer 트래픽 이상" /><link rel="canonical" href="https://yongheonn.github.io/posts/font-traffic/" /><meta property="og:url" content="https://yongheonn.github.io/posts/font-traffic/" /><meta property="og:site_name" content="YongHeon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-12T02:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="aws data transfer 트래픽 문제(폰트)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yongheon Choi","url":"https://github.com/yongheonn/"},"dateModified":"2023-04-12T02:00:00+09:00","datePublished":"2023-04-12T02:00:00+09:00","description":"aws data transfer 트래픽 이상","headline":"aws data transfer 트래픽 문제(폰트)","mainEntityOfPage":{"@type":"WebPage","@id":"https://yongheonn.github.io/posts/font-traffic/"},"url":"https://yongheonn.github.io/posts/font-traffic/"}</script><title>aws data transfer 트래픽 문제(폰트) | YongHeon</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="YongHeon"><meta name="application-name" content="YongHeon"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/android-chrome-512x512.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">YongHeon</a></div><div class="site-subtitle font-italic">Yongheon's development blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/yongheonn" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yongheonn99','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>aws data transfer 트래픽 문제(폰트)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>aws data transfer 트래픽 문제(폰트)</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1681232400" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2023-04-12 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/yongheonn/">Yongheon Choi</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="596 단어"> <em>3 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="aws-data-transfer-트래픽-이상">aws data transfer 트래픽 이상</h1><p>불과 하루도 안되어 프리티어 공짜 한도인 1gb 중 거의 700mb를 사용했다.</p><p>처음엔 해킹도 의심했지만 그렇다기엔 이상한 점이 한둘이 아니라, 이 트래픽을 추적하다보니 ttf 파일이 혼자 600mmb 정도 차지하고 있었다.</p><p>ttf 파일은 리액트 프로젝트 생성시 자동으로 assets/font에 들어가 있었고, 정확히 이 폴더 내 용량 합이었다.</p><p>이 용량이 무려 13mb라 굉장히 트래픽에 부담되는 현상이 일어난 것이다.</p><p>이 때문에 웹사이트 로드도 굉장히 느려졌었고, 어떻게든 해결해야겠다고 생각했다.</p><p>처음엔 cdn을 활용해서 폰트를 서비스할까 생각했지만, 이 역시 전보단 훨씬 낫겠지만 지연이 발생하고, 앞으로 남은 한도를 생각하면 더 트래픽을 아낄 필요성이 느껴졌다.</p><p>그래서 woff 형식의 압축으로 직접 제공할까 생각했지만 이 역시 한글 폰트를 제공하기에 너무 용량이 컸다.</p><p>subset을 활용할 생각도 했지만, 게시판 특성상 자주 않쓰는 한글 글자도 활용될 확률이 높아 만에 하나 그런 상황이 발생할 것을 상상하면 한 문장 내에 폰트가 서로 다른 현상은 반갑지 않았다.</p><p>그렇기에 트래픽은 하나도 발생하지 않는 src: local로 font-face를 설정하고, 최대한 사용자 로컬 환경에서 폰트를 활용하기로 했다.</p><p>사실 로컬에만 의존하는 것은 사용자 환경에 따라 굉장히 서비스가 달라질 환경이 있어 실제 서비스에선 보조적으로 활용하는 것이 좋아보였지만, 일단 이번달은 남은 무료 트래픽도 거의 없고 해서, 최대한 아끼기로 했다.</p><p>다음 달엔 local과 woff2를 활용해서 폰트를 제공하지 않을까 싶다.</p><p>그리고, 여기서 더 아끼기 위해 캐시 설정을 하기로 했고, 그것은 따로 다른 포스팅에서 다뤄놓았다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href="/categories/%EC%9B%B9/" >웹</a >, <a href="/categories/%EA%B0%9C%EB%B0%9C-%EA%B3%A0%EB%AF%BC/" >개발 고민</a ></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/font/" class="post-tag no-text-decoration" >font</a> <a href="/tags/ttf/" class="post-tag no-text-decoration" >ttf</a> <a href="/tags/traffic/" class="post-tag no-text-decoration" >traffic</a> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/data-transfer/" class="post-tag no-text-decoration" >data-transfer</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2" ><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=aws+data+transfer+%ED%8A%B8%EB%9E%98%ED%94%BD+%EB%AC%B8%EC%A0%9C%28%ED%8F%B0%ED%8A%B8%29+-+YongHeon&url=https%3A%2F%2Fyongheonn.github.io%2Fposts%2Ffont-traffic%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=aws+data+transfer+%ED%8A%B8%EB%9E%98%ED%94%BD+%EB%AC%B8%EC%A0%9C%28%ED%8F%B0%ED%8A%B8%29+-+YongHeon&u=https%3A%2F%2Fyongheonn.github.io%2Fposts%2Ffont-traffic%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fyongheonn.github.io%2Fposts%2Ffont-traffic%2F&text=aws+data+transfer+%ED%8A%B8%EB%9E%98%ED%94%BD+%EB%AC%B8%EC%A0%9C%28%ED%8F%B0%ED%8A%B8%29+-+YongHeon" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/github_blog_issue/">Liquid Exception: undefined method gsub for 502:Integer in</a><li><a href="/posts/cors_issue/">갑작스러운 504 및 502 cors 에러</a><li><a href="/posts/db_thinking_1/">Mysql index vs multi tables</a><li><a href="/posts/jwt_thinking_3/">JWT 토큰 인증에 대한 고민 3</a><li><a href="/posts/notice_board_plan/">게시판 계획</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/access-token/">access token</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/jwt/">jwt</a> <a class="post-tag" href="/tags/refresh-token/">refresh token</a> <a class="post-tag" href="/tags/db/">db</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/index/">index</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cache_setting/"><div class="card-body"> <em class="small" data-ts="1681232400" data-df="YYYY-MM-DD" > 2023-04-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>aws s3 정적 사이트 캐시 문제</h3><div class="text-muted small"><p> html, css, js 캐시 문제 해결 기본적으로 리액트 빌드시 index.html은 그대로지만, static 폴더의 css와 js는 매번 파일명이 변경되어 새로 업로드된다. 여기에 어차피 html에서 로드할 css와 js가 결정되기에 css와 js의 캐시를 최대한 길게 잡아도 업데이트할 때는 새로운 css와 js가 적용되며, 업데이트되지 않았을...</p></div></div></a></div><div class="card"> <a href="/posts/cors_issue/"><div class="card-body"> <em class="small" data-ts="1696669200" data-df="YYYY-MM-DD" > 2023-10-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>갑작스러운 504 및 502 cors 에러</h3><div class="text-muted small"><p> 어느날 갑자기 api 통신이 안되는 오류 발생 주기적으로 yongheonn.com 사이트를 점검하던 어는 날, 아무것도 건드린 적 없는데, 잘되던 사이트에 문제가 발생했다. 프론트 단의 사이트 자체는 문제가 없었으나 백엔드와의 통신이 먹통이 되었는지, 게시판 목록을 받지 못하고 있던 것이다. 그래서, 일단 개발자 도구를 통해 네트워크 탭을 확인했고,...</p></div></div></a></div><div class="card"> <a href="/posts/db_thinking_1/"><div class="card-body"> <em class="small" data-ts="1668051000" data-df="YYYY-MM-DD" > 2022-11-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mysql index vs multi tables</h3><div class="text-muted small"><p> 하나의 테이블과 인덱스 vs 여러개의 테이블 결론 hash 파티셔닝 사용 여러개의 테이블은 성능 저하 인덱스의 적절한 사용은 테이블 분리보다 성능이 좋다. 생각해보면 테이블 분리는 테이블 검색 비용 증가로 모든 테이블 성능이 나빠진다. 서버를 증설해서 서로 다른 서버에 테이블을 분리시킬 것이 아니면 하나의 테이블에서 인덱스 사용이 좋아보인다.</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/cache_setting/" class="btn btn-outline-primary" prompt="이전 글"><p>aws s3 정적 사이트 캐시 문제</p></a> <a href="/posts/submodule/" class="btn btn-outline-primary" prompt="다음 글"><p>github 민감한 정보 관리</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/yongheonn">yongheon</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/access-token/">access token</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/jwt/">jwt</a> <a class="post-tag" href="/tags/refresh-token/">refresh token</a> <a class="post-tag" href="/tags/db/">db</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/index/">index</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
